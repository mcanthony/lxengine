<!DOCTYPE html>
<html>
    <head>
      <title>Raytracer</title>
      <link type="text/css" href="../shared/style/default.less" rel="stylesheet/less" />
      <link type="text/css" href="style.less" rel="stylesheet/less" />
      
      <script type="text/javascript" src="../shared/script/extern/less-1.1.3.min.js"></script>
      <script type="text/javascript" src="../shared/script/extern/jquery-1.6.4.min.js"></script>
      <script type="text/javascript" src="../shared/script/lx.webUtil-0.1.0.js"></script>

      <script type="text/javascript">
      <!--
        includeScriptFiles(
          "../shared/script/lx.keycodes.js",
          "../shared/script/lx.core-0.1.1.js",
          "../shared/script/lx.engine.js",
          "../shared/script/lx.vec.js",
          "../lxlang/lxlang.js",
          "../shared/script/lx.patterns-0.1.0.js",
          "../shared/script/lx.mappers.lxlang",
          "raytracer.js",
          "loadscene.js"
        );
      -->
      </script>

    </head>
    <body>
       <div id="body-wrap1">
        <h1>Ray Tracer</h1>

        <h2>About</h2>
        <p>
                <strong>Project Status:</strong>&nbsp;&nbsp;
                <span style="font-size: 80%; color: #CCC">
                    <span style="color: #37A; font-weight: bold; text-shadow: #DDD 0px 0px 2px">Prototype</span> |
                    Development |
                    Alpha |
                    Beta |
                    Production 
                </span>
            </p>
        <div id="insert-toc">
          <p>
              The ray tracer is currently a work-in-progress for testing and demonstrating LxWeb, a javascript engine for visualization 
              and simulation.
          </p>
          <p class="note" style="margin-top: 2em">
            <span style="color: Red; font-style: italic">Warning:</span>&nbsp;
            As this is most definitely in the prototype stage, it has only been tested on the latest version of 
            <strong>Google Chrome</strong>.
          </p>
        </div>

        <h2>Demonstration</h2>

        <div class="layout-row">
            <div>
                <canvas id="canvas" width="256" height="512" style="border: 1px solid #555; box-shadow: 3px 3px 6px #888; margin-right: 64px;"></canvas>
                <div>
                    <span id="renderTime"></span>
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <a id="download" target="_blank">download</a>
                </div>
            </div>
            <div>
                <p class="warning">
                    These options are <strong>in development</strong> and are only partly functional.
                </p>
                <form>
                    <fieldset style="border-radius: 4px">
                        <legend>Options</legend>
                        <table>

                            <tr>
                                <td>Scene</td>
                                <td>
                                    <select id="ui-sceneUrl">
                                        <option selected value="'scene_00.xml'">scene_00.xml</option>
                                        <option value="'scene_01.xml'">scene_01.xml</option>
                                    </select>
                                </td>
                            </tr>

                            <tr>
                                <td>Presets</td>
                                <td>
                                    <select>
                                        <option>Quick</option>
                                        <option selected>Draft</option>
                                        <option>High-Quality</option>
                                        <option>Ultra</option>
                                    </select>
                                </td>
                            </tr>

                            <tr>
                                <td>Resolution</td>
                                <td>
                                    <select id="ui-resolution" data-type="ivec2">
                                        <option value="[1024,1024]">1024 x 1024</option>
                                        <option value="[1024,256]">1024 x 256</option>
                                        <option value="[960,240]">960 x 240</option>
                                        <option value="[512,512]">512 x 512</option>
                                        <option value="[256,512]">256 x 512</option>
                                        <option selected value="[256,384]">256 x 384</option>
                                        <option value="[128,128]">128 x 128</option>
                                    </select>
                                </td>
                            </tr>

                            <tr>
                                <td>Sample Count</td>
                                <td>
                                    <select id="ui-sampleCount" data-type="float">
                                        <option>1</option>
                                        <option selected>5</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                    </fieldset>
                    <div>
                        <a href="#" id="rerender">Render</a>
                    </div>
                </form>
            </div>
        </div>

        <h2>Architecture &amp; Implementation</h2>

        <h2>Todo</h2>
        <ul>
          <li>Many things</li>
        </ul>


        <script type="text/javascript">
        <!--
            var options =
            {
              sampleCount : 5,
              sceneUrl : "scene_00.xml",
              resolution : [ 256, 384 ]
            };

            $(document).ready(function () {

              $("#insert-toc").tableOfContentsMenu();

              for (var key in options) {
                $("#ui-" + key).val(JSON.stringify(options[key]));
                $("#ui-" + key).change((function (key) {
                  return function () {
                    try {
                      var value;
                      eval("value = " + $(this).val() + ";");
                      options[key] = value;
                    } catch (e) {
                      console.log("ERROR: Evaluation error in ui option");
                    }
                  };
                })(key));
              }

              options.oncomplete = function (stats) {
                $("#renderTime").text("Render time: " + stats.renderTime +"ms");
                $("#download").attr("href", stats.dataUri);
              }

              $("#rerender").click(function () {
                var scene = loadScene(options.sceneUrl);
                engine.changeState(new raytracer.RenderLoop($("#canvas")[0], scene, options));
                return false;
              });

              engine.gametick = 0;
              engine.run(new raytracer.RenderLoop($("#canvas")[0], loadScene(options.sceneUrl), options));

            });
        -->
        </script>

        <!-- Google Analytics -->         <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-604613-10']);
            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();        </script> 

    </body>
</html>
